# Chapter 08 테이블 뷰를 이용한 데이터 목록 구현
----

## 테이블 뷰 컨트롤러
테이블 뷰 컨트롤러는 뷰 컨트롤러를 바탕으로 만들어진 특수한 컨트롤러로, 목록 형식의 데이터를 화면에 표현하는 데에 사용된다.

----
**[ 테이블 뷰 컨트롤러의 계층 구조 ]**
- **Table View Controller** (Scene을 담당)
    - **Table View** (최상위 루트 뷰)
        - **Table View Cell** (각각의 행)
            - **Content View** (각 행의 내용)

----
- UITableViewController : 테이블 뷰 컨트롤러가 구현된 클래스
    - 델리게이트 패턴에 기반한 다양한 메소드가 정의되어 있다.

----
#### 프로토타입 셀
프로토타입 셀(Prototype Cell)은 테이블 뷰의 셀을 원하는 대로 쉽게 디자인할 수 있도록 해주는 객체로, 테이블 뷰 설계에 걸리는 시간을 대폭 줄여준다.

프로토타입 셀은 아래의 영역들로 구분된다.
- **Cell Content** : 셀에 표현될 콘텐츠
    - Image
    - Text
- **Accessory View** : 콘텐츠의 부가 정보 여부를 암시

- Editing control : 삭제 버튼, 셀 순서 재배치 컨트롤 등 제공
- Reordering control : 행 추가(+) 삭제(-) 버튼 등 제공


----
**[ Value Object 패턴 ]**
데이터 저장을 전담하는 클래스를 별도로 분리하는 설계 방식을 Value Object 패턴이라고 부르고, 줄여서 VO라고 한다.
Value Object 패턴은 보통 데이터 저장을 위한 클래스임을 쉽게 식별할 수 있게 하려고 클래스의 마지막에 VO라는 접미사를 붙인다.
클래스 인스턴스 내부의 속성에 각각의 데이터들을 담아주고, 전달할 때에는 클래스 인스턴스를 전달하면서 내부의 값도 함께 전달할 수 있다.


**[ lazy 키워드 ]**
- lazy 키워드와 함께 선언된 변수는 **참조되는 시점에 맞추어 초기화되기 때문에 메모리 낭비를 줄일 수 있다.**
- lazy 키워드가 붙은 프로퍼티는 다른 일반 프로퍼티들이 모두 초기화된 후 맨 마지막에 초기화될 뿐만 아니라, 초기화되는 시점도 통제 가능하다.







----
## 테이블 뷰 - 데이터 소스 연동하기
- 1) **tableView(_:numberOfRowsInSection)** : 테이블 뷰가 생성해야 할 행의 개수를 반환함
- 2) **tableView(_:cellForRowAt:)** : 각 행이 화면에 표현해야 할 내용을 구성하는 데에 사용 (개별적인 테이블 셀 객체를 반환함. 화면에 표현해야 할 목록의 수만큼 반복 호출됨)

위의 메소드들은 UITableViewDataSource 프로토콜에 정의되어 있고, UITableViewController 클래스는 이 프로토콜을 상속받고 있다.
UITableView 클래스에 이미 구현되어 있는 메소드이기 때문에 override해준다.
이 메소드들은 델리게이트 패턴과 동일한 방식으로 동작하지만 동작이나 이벤트에 관한 메소드는 아니고 **iOS 시스템이 필요에 의해 호출하는 메소드**이다. 그렇기 때문에 작성만 해두면 시스템이 알아서 호출하게 된다.

----
**[ 사용자의 액션 처리를 위한 핵심 메소드 ]**
- **tableView(_:didSelectRowAt:)** : UITableViewDelegate 프로토콜에 정의되어 있고, 사용자가 특정 행을 선택했을 때 호출된다. 선택한 내용에 맞는 액션 처리에 사용됨







----
## 커스텀 프로토타입 셀
- iOS에서 기본적으로 제공하는 템플릿보다 더 복잡한 형태로 셀을 만들거나 임의로 UI 구성을 변경하고 슾이면 **커스텀 프로토타입 셀**을 직접 구현해야 한다.

**[ 커스텀 프로토타입 셀 구성 방법 1 - Tag 속성 값 부여하기]**
- 1) 스토리보드 상에서 프로토타입 셀을 [Custom] 스타일로 지정한 다음, 직접 Label 등을 추가해서 구성해준다.
- 2-1) **추가한 요소들에 Tag값을 부여**함으로써 소스코드 상에서 셀 내부 객체를 참조할 수 있도록 해준다. (커스텀 시에는 textLabel, detailTextLabel과 같은 기본 속성으로 참조할 수 없기 때문에)
- 2-2) **viewWithTag(_:)** 메소드를 이용하여 객체를 불러온다. (객체의 Tag 값 인자로 사용)
- 3) 반환된 객체를 적절한 타입(UILabel 등)으로 캐스팅해준다. (반환 타입 옵셔널임)

**[ 커스텀 프로토타입 셀 구성 방법 2 - 커스텀 클래스와 아울렛 변수 연결 (권장)]**
 ==> Tag 속성을 사용하는 방식보다 관리 및 유지보수가 편함
- 1) 스토리보드 상에서 프로토타입 셀을 [Custom] 스타일로 지정한 다음, 직접 Label 등을 추가해서 구성해준다.
- 2-1) UITableViewCell을 상속받는 커스텀 클래스를 정의한 다음 프로토타입 셀과 연결해준다.
- 2-2) 커스텀 클래스에 프로토타입 셀의 객체에 대한 아울렛 변수를 만들어준다.
- 3) dequeueReusableCell()메소드로 불러온 셀 객체를 커스텀 클래스로 캐스팅해주면 바로 참조 가능하다.





----
## 이미지 뷰
- **UIImageView** : 이미지 뷰를 구현하는 기본 클래스
- 이미지 뷰의 **.image 속성에 UIImage 타입으로 작성된 이미지 객체를 대입**함으로써 화면에 표시할 수 있다.
- 읽어온 이미지를 메모리에 저장한 뒤 호출하는 방식
    - I/O 발생으로 인한 성능 저하를 막을 수 있음
```
var img = UIImage(named: <프로젝트 내 파일 경로>)
```
- 캐싱되지 않게 이미지 읽어오는 방식
    - 자주 쓰지 않는 이미지라면 이 방식이 메모리 관리 면에서 효율적이다
```
var img = UIImage(contentsOfFile: <프로젝트 내 파일 경로>)
```
